<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<title>商城首页</title>
		<meta name="viewport" content="initial-scale=1, maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<script src="js/jquery.min.js"></script>
		<script src="js/mui.min.js"></script>
		<script src="js/TouchSlide.1.1.js"></script>
		<link href="css/goods.css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="css/iconfont.css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="css/mui.min.css">
		<link rel="stylesheet" type="text/css" href="css/home.css">
		<link rel="stylesheet" type="text/css" href="shop_iconfont/iconfont.css">
		<style type="text/css">
			#segmentedControl {
				font-size: 12px;
				padding: 0;
				border: 0px solid #D8D8D8;
				background: #FFFFFF;
			}
			
			#segmentedControl .mui-control-item {
				border: 0px;
				color: #C0C0C0;
			}
			
			#segmentedControl .mui-active {
				background: #FFFFFF;
				color: #555555;
			}
			.mui-bar-tab .mui-tab-item.mui-active {
				color: #f4811f;
			}
			
			body {
				margin: 0;
				background: #eee;
				font-size: 1.2rem;
				line-height: 1.6;
				color: #0e0e0e;
				font-family: 'microsoft yahei', Verdana, Arial, Helvetica, sans-serif;
			}
			
			.mui-table-view-cell {
				padding-right: 45px;
			}
			
			.mui-media-body {
				padding: 15px 0px 0px 0px;
				padding-left: 13px;
			}
			
			.mui-pull-left {
				display: block;
				max-width: 135px;
			}
			
			.wrap {
				padding-bottom: 3.8rem;
			}
			
			#HDDDMin ul li {
				width: 8px;
				height: 8px;
			}
			
			.mui-iframe-wrapper {
				position: relative;
				height: 50rem;
				bottom: 0px;
			}
			
			* {
				margin: 0px;
				padding: 0px;
			}
			
			ul li {
				list-style: none;
			}
			
			.view-mui-1 {
				color: #f35a1f;
				font-size: 16px;
				font-weight: bold;
				border-top: 1px solid #efefef;
				border-bottom: 1px solid #efefef;
			}
			
			.item-title-row ul li {
				margin: 4px 0px;
			}
			
			.mui-tt {
				width: 90%;
				height: 60px;
				margin: 0 auto;
				padding: 2px 2px;
			}
			
			.mui-tt img {
				width: 70px;
				height: 46px;
				border-right: 1px solid #f1f1f1;
			}
			
			.mui-poster img {
				float: left;
			}
			
			.mui-slider-item img {
				height: 50px;
				width: 100%;
			}
			
			.mui-slider-item img:hover {
				transition: all ease 10s;
			}
			
			/*小广告轮播*/
			.mui-banner-z {
				width: 100%;
				height: 50px;
			}
			
			@media screen and (min-width:0px) and (max-width:425px) {
				.mui-banner-z {
					width: 100%;
					height: 100px;
				}
				.center{
					max-width:75%;
				}
			}
			@media screen and (min-width:425px) and (max-width:1204px) {
				.mui-banner-z {
					width: 100%;
					height: 100px;
				}
				.center{
					max-width:85%;
				}
			}
			
			@media screen and (min-width:1204px) and (max-width:1604px) {
				.mui-banner-z {
					width: 100%;
					height: 150px;
				}
				.center{
					max-width:95%;
				}
				
			}
			
			@media screen and (min-width:1604px) and (max-width:3400px) {
				.mui-banner-z {
					width: 100%;
					height: 350px;
				}
				.center{
					max-width:95%;
				}
			}
			
			
			
			.mui-text-p {
				overflow: hidden;
				text-overflow: ellipsis;
				white-space: nowrap;
			}
			/*广告*/
			/* .right-mui-sapn{background:red;;}*/
			
			.mui-jinghuan {
				border: 1px solid red;
				color: red;
				padding: 1px 4px;
				border-radius: 4px;
			}
			
			.mui-manbody {
				margin-left: 5px;
			}
			
			.wang {
				width: 70%;
				position: relative;
				left: 4px;
				margin: 4px 5px;
				padding: 1px 1px;
				display: block;
				overflow: hidden;
				text-overflow: ellipsis;
				white-space: nowrap;
			}
			
			@media only screen and (max-width:310px) {
				.mui-poster img {
					display: none;
				}
				.right-mui-sapn {
					width: 100%;
					margin: 0 auto;
				}
			}
		</style>
		
	</head>

	<body>
		<header class="mui-bar mui-bar-nav" style="background:#212123;position: fixed;margin-bottom: 2rem;box-shadow: 0 0px 0px #212123;">
			<div class="top_Out">
				<div class="right" style="background:none;float:right;"><span class="mui-icon myico myicos iconfont waitUp" style="margin: 7px auto auto 11px;">&#xe608;</span></div>
				<div class="right" style="background: none;color: white;float:left"><span class="mui-icon myico myicos iconfont waitUp" style="margin: 7px auto auto 1px;">&#xe607;</span></div>
			</div>
			<div class="center" style="border-radius:30px; margin:0 auto;background:#646464;position:relative;top:-35px;">
				<div class="mui-input-row">
					<span class="mui-icon mui-icon-speech" id="mui-icon-speech" style="color: #fff;"></span>
					<input type="text" id="mui-input-speech" class="mui-input-speech mui-input-clear" style="margin-bottom:none;color:#fff;">
				</div>
			</div>
		</header>	

		<div class="wrap" style="padding-top: 4rem;">
			<!--轮播开始-->
			<section id="banner">
				<div id="slideBox" class="slideBox">
					<div class="bd">
						<ul id="BoxImg">
							
						</ul>
					</div>
					<div class="hd">
						<ul></ul>
					</div>
				</div>
			</section>
			<!--项目选项-->
			<section class="calssify" style="background:#fff;">
				<div class="slideBox" id="slideBox-calssify" style="padding-bottom: 2rem;    font-size: 10px;">
					<div class="bd">
						<ul>
							<li>
								<div class="box">
									<div class="item TypeMain" style="cursor: pointer;" id="98d88969-4164-4735-ac3d-f04f410278ad">
										<span class="img"><img src="img/cyms.png" alt=""></span><span>餐饮美食 </span></div>
									<div class="item TypeMain" style="cursor: pointer;" id="9d3f18d1-2497-4db4-a88b-02aab2d938f9">
										<span class="img"><img src="img/xxyl.png" alt=""></span><span>休闲娱乐</span></div>
									<div class="item TypeMain" style="cursor: pointer;" id="dc513731-15f9-4420-9f0c-ff45d3751544">
										<span class="img"><img src="img/jdzs.png" alt=""></span><span>酒店住宿</span></div>
									<div class="item TypeMain" id="0ed7dc5a-d824-448f-bfb2-e446d10cbf8e">
										<span class="img"><img src="img/lycx.png" alt=""></span><span>旅游出行</span></div>
										<div class="item TypeMain" id="51e0d5a6-126c-4dd0-96e0-3484cc2e3a28">
										<span class="img"><img src="img/ppsj.png" alt=""></span><span>双倍积分</span></div>

								</div>
								<div class="box">
									<div class="item TypeMain" id="e5b1faca-e7e9-4dff-94eb-98f0de1b8307">
										<span class="img"><img src="img/jzjc.png" alt=""></span><span>家装建材</span></div>
									<div class="item TypeMain" id="837ec631-d406-4c30-bc74-cdb31a8638cf">
										<span class="img"><img src="img/jypx.png" alt=""></span><span>教育培训</span></div>
									<div class="item TypeMain" id="f92ae2d4-fb8d-4b09-a3ed-52d993f1dcee">
										<span class="img"><img src="img/mflr.png" alt=""></span><span>美发丽人</span></div>
									<div class="item TypeMain" id="8642f0b0-21da-4409-bda7-9300556fb8dc">
										<span class="img"><img src="img/myqz.png" alt=""></span><span>母婴亲子</span></div>
									<div class="item TypeMain" style="cursor: pointer;" id="58b7bdf3-4646-4326-98b9-c0545fa54e09">
										<span class="img"><img src="img/dyyc.png" alt=""></span><span>电影演出</span></div>
								</div>
							</li>
							<li>
								<div class="box">
									<div class="item TypeMain" id="67c412b9-57fd-4f4d-86c7-32c2ba82f647" style="cursor: pointer;" >
										<span class="img"><img src="img/qcfc.png" alt=""></span><span>汽车房产 </span></div>
									<div class="item TypeMain" id="df1459d5-d3e2-4761-99d3-332016fbaa4f" style="cursor: pointer;">
										<span class="img"><img src="img/jhbb.png" alt=""></span><span>结婚必备</span></div>
									<div class="item TypeMain" id="de3ca654-2ae3-480c-96ac-dce34e4b7b4d">
										<span class="img"><img src="img/xhdg.png" alt=""></span><span>鲜花蛋糕</span></div>
									<div class="item TypeMain"  id="c7d6430a-33a3-4d1a-b3a8-c7fd12451e9f">
										<span class="img"><img src="img/fqsc.png" alt=""></span><span>分期商城</span></div>
									<div class="item">
										<span class="img"><img src="img/jqqd.png" alt=""></span><span>敬请期待</span></div>
								</div>
								<div class="box">
									
									<div class="item">
										<span class="img"><img src="img/jqqd.png" alt=""></span><span>敬请期待</span></div>
									<div class="item">
										<span class="img"><img src="img/jqqd.png" alt=""></span><span>敬请期待</span></div>
									<div class="item">
										<span class="img"><img src="img/jqqd.png" alt=""></span><span>敬请期待</span></div>
									<div class="item">
										<span class="img"><img src="img/jqqd.png" alt=""></span><span>敬请期待</span></div>
									<div class="item">
										<span class="img"><img src="img/jqqd.png" alt=""></span><span>敬请期待</span></div>
								</div>
							</li>
						</ul>
					</div>
					<div class="hd" style="bottom: 0rem;" id="HDDDMin">
						<ul></ul>
					</div>
				</div>
			</section>
			
			<div style="width: 100%;height: 4rem;border:0;border-top:1px solid #D8D8D8;border-bottom:1px solid #D8D8D8;background-color: white;">
				<div  style="text-align: center;font-size: 18px;padding-top: 0.5rem;padding-bottom:0.5rem;color: #555555;">—— 推荐产品 ——</div>
			</div>
			
			<div id="segmentedControl" class="mui-segmented-control">
				<a class="mui-control-item controlToList mui-active" id="1" href="#item1">综合排序</a>
				<a class="mui-control-item controlToList" id="2" href="#item3">销量排序 </a>
				<a class="mui-control-item" id="3" href="#item4">距离最近</a>
			</div>
			<div id="typeList1" class="listtype" style="display: none;">
				
			</div>
			<div id="typeList2" class="listtype" style="display: none;">
				<div style="margin-bottom: 0.8rem;margin-left: 1rem;">您未登陆</div>
				<div style="margin-bottom: 0.8rem;margin-left: 1rem;">不能查看</div>
				<div style="margin-bottom: 0.8rem;margin-left: 1rem;">区域片区</div>
			</div>
			<secltion class="all_goods">
		     	<ul class="mui-table-view mui-grid-view mui-index" style="font-size: 10px;padding: 1px 0 8px 0;background-color: #cfa972;" >
			     	
		    	</ul>            
		    </secltion>
			
		</div>

		<nav class="mui-bar mui-bar-tab "  style="background-color: #cfa972;font-size: 12px;color:white;">
			<a id="index" class="mui-tab-item  tab-item" href="index.html">
				<span class="mui-icon myico icon-fz icon iconfont " style="color:white;">&#xe60d;</span>
				<span class="mui-tab-label tab-label" style="font-size:10px;color:white;">首 页</span>
			</a>
			<a id="integral" class="mui-tab-item tab-item" href="integral.html">
				<span class="mui-icon myico  icon-lb icon iconfont" style="color:white;">&#xe60b;</span>
				<span class="mui-tab-label"  style="font-size:10px;color:white;">积 分</span>
			</a>
			<a id="MainBuy" class="mui-tab-item tab-item" href="MainBuy.html">
				<span class="mui-icon myico icon-fjmd icon iconfont "  style="color:white;">&#xe60e;</span>
				<span class="mui-tab-label"  style="font-size:10px;color:white;">商 圈</span>
			</a>
			<a id="MainShop" class="mui-tab-item tab-item" href="MainShop.html">
				<span class="mui-icon myico icon-fjmd iconfont"  style="color:white;">&#xe6de;</span>
				<span class="mui-tab-label"  style="font-size:10px;color:white;">商 城</span>
			</a>
			<a id="personage" class="mui-tab-item tab-item" href="personage.html">
				<span class="mui-icon myico icon-gyw icon iconfont"  style="color:white;">&#xe610;</span>
				<span class="mui-tab-label"  style="font-size:10px;color:white;">个人中心</span>
			</a>
		</nav>

		<script src="js/MD5S.js"></script>
		<script src="js/TravelTailorSafeInterface.js"></script>
		<script type="text/javascript">
			TouchSlide({
					slideCell: "#slideBox-calssify",
					titCell: ".hd ul",
					mainCell: ".bd ul",
					effect: "left",
					autoPage: true
				});
			var slider = mui("#slider");
			var Shopindex = 0;
			var Murl = "";
			var imgsrc = httppp+"/Images/ExpertImg/admin/gg/";
			var uil = null;
			var CompanyImgsrc = httppp+"/Images/ExpertImg/admin/CompanyImg/";

			slider.slider({
				interval: 500
			});
			

			
			
					
			var isshop=false;
			function AddShopList() {
				if(!isshop){
					isshop=true;
					setTimeout(function(){
							resetdata = false;
							var table = document.body.querySelector('.mui-table-view');
							var li = document.createElement('li');
							li.className = 'gclLoding mui-media';
							var lihtml = '<div style="text-align:center;">' + ishasdata + '</div>';
							li.innerHTML = lihtml;
							table.appendChild(li);
							var ar = new Array();
							var ph = {
								Collection: []
							};
							ar.Condition = ph;
							ar.InterfaceAddress = "api/ShopInfo";
							ar.Name = "Yl_ProductInfo";
							ar.OrderBy = "CreationDate desc";
							ar.Index = 0 + Shopindex;
							ar.Size = 10;
							ar.Handshake_Time = CurentTime('-', true);
							aes(ar, "endshop");
					},50);
				}
			}
			var ishasdata = "加载数据中...";

			function opinwin(id, ProPhotosId) {
					if(plus.webview.getWebviewById("shop")==""||plus.webview.getWebviewById("shop")==undefined||plus.webview.getWebviewById("shop")==null){}
					else
					{plus.webview.getWebviewById("shop").close();}
				var nwaiting = plus.nativeUI.showWaiting();//显示原生等待框
								    webviewContent= plus.webview.create("details.html?id=" + id + "&img=" + ProPhotosId,"shop",{render:'always',});//后台创建webview并打开show.html
								    webviewContent.show("slide-in-right",200); //把新webview窗体显示出来，显示动画效果为速度200毫秒的右侧移入动画
						
				
			}
			var resetdata = false;

			function endshop(rd) {
				var TData = eval("(" + rd + ")");
				var table = document.body.querySelector('.mui-table-view');
				var gclloding = document.getElementsByClassName("gclLoding")[0];
				table.removeChild(gclloding);
				if(TData == undefined || TData.length == undefined || TData.length == 0) {
					ishasdata = "没有更多的数据";
				} else {
					Shopindex++;
					var cells = document.body.querySelectorAll('.mui-table-view-cell');
					var s1=0;
					for(var i = 0, len = TData.length; i < len; i++) {
						if(s1>1){s1=0;}
						s1++;
						var li = document.createElement('li');
						li.className = 'mui-table-view-cell mui-media mui-col-xs-6 gcls'+s1;
						li.setAttribute("style","padding: 0;margin-right:0px;");
						var lihtml = '';
						lihtml+='<a href="javascript:void(0);" style="margin:0 1px 2px 1px;background-color: #fff;" onclick=opinwin("' + TData[i].Id + '","' + TData[i].ProPhotosId + '")>';
						lihtml+='<img class="mui-media-object" src="' + CompanyImgsrc + TData[i].Id + '_80x80.jpg?1=1" style="min-width: 120px;">';
						lihtml+='<h3 class="all_goods_h3" style="font-size: 14px;padding-left:5px;">' + TData[i].ProName+'</h3>';
						lihtml+='<div class="all_goods_des"><span class="all_goods_color" style="font-size: 12px;">￥' + TData[i].proprice + '</span><s class="O_price" style="font-size: 10px;">￥' + TData[i].Oldprice + '</s><span style="color: #CCCCCC;float:right;margin-right: 2px;padding-top: 1px;font-size:8px;">售999</span></div>';
						lihtml+=' </a>';
						li.innerHTML = lihtml;
						table.appendChild(li);
					}
				}
				resetdata = true;
				isshop=false;
        		plus.nativeUI.closeWaiting();

			}

			function GetShopList() {
				var ar = new Array();
				var ph = {
					Collection: [
						
					]
				};
				ar.Condition = ph;
				ar.InterfaceAddress = "api/ShopInfo";
				ar.Name = "stopAndImg";
				ar.OrderBy = "CreationDate desc";
				ar.Index = 0;
				ar.Size = 5;
				ar.Handshake_Time = CurentTime('-', true);
				aes(ar, "Getshop");
			}

			function Getshop(rd) {
				var TData = eval("(" + rd + ")");

				if(TData == undefined || TData.length == undefined || TData.length == 0) {} else {
					Shopindex = 1;
					var table = document.body.querySelector('.mui-table-view');
					var cells = document.body.querySelectorAll('.mui-table-view-cell');
					table.innerHTML = "";
					for(var i = 0, len = TData.length; i < len; i++) {
						var li = document.createElement('li');
						li.className = 'mui-table-view-cell mui-media';
						var lihtml = '<a style="margin-right:-10px;"  onclick=opinwin("' + TData[i].Id + '")>';
						lihtml += '<img class="mui-pull-left" style="width:50%;" src="' + CompanyImgsrc + TData[i].Id + '_80x80.jpg">';
						lihtml += '<div class="mui-media-body" style="font-size:16px;">' + TData[i].ProName;
						lihtml += '<div class="mui-ellipsis" style="font-size:13px;">' + TData[i].ProDisInfo + '</div>';
						lihtml += '<p class="jiage" style="font-size:12px;"><span class="jiage_color">' + TData[i].proprice + '</span><s>原' + TData[i].Oldprice + '</s></p></div>';
						lihtml += '</a>';

						li.innerHTML = lihtml;

						table.appendChild(li);
					}

					console.log(table.innerHTML);
					mui('#pullrefresh').pullRefresh().endPulldownToRefresh(); //refresh completed
				}
			}
			



	var isToGoUrl=false;
	window.onload = function() {
		var navs = document.querySelectorAll(".mui-tab-item");
								for(n in navs) {
									if(navs[n].getAttribute != undefined) {
										obj = navs[n].getAttribute('id');
										document.getElementById(obj).addEventListener("tap", function() {
											if(!isToGoUrl){
												var thisid=this.id;
												isToGoUrl=true;
												var ToshowWebView= plus.webview.getWebviewById(thisid);
												if(ToshowWebView==""||ToshowWebView==undefined){
													var nwaiting = plus.nativeUI.showWaiting();//显示原生等待框
												    webviewContent= plus.webview.create(thisid + '.html',thisid,{render:'always',});//后台创建webview并打开show.html
												   webviewContent.addEventListener("rendered", function() { //注册新webview的渲染完成事件
												        nwaiting.close(); //新webview的载入完毕后关闭等待框
												        webviewContent.show("slide-in-right",300); //把新webview窗体显示出来，显示动画效果为速度200毫秒的右侧移入动画
												    }, false);
					                                isToGoUrl = false;
													
												}else{
													plus.webview.show(ToshowWebView,'slide-in-right',200);
		        									
													isToGoUrl=false;
												}
										}
										});
									}
								}
											
			//从服务器获取数据
			//业务数据获取完毕，并已插入当前页面DOM；
			//注意：若为ajax请求，则需将如下代码放在处理完ajax响应数据之后；
			mui.plusReady(function() {
			});
				setTimeout(function (){
					BindImg();
					var range = 80; //距下边界长度/单位px
					var elemt = 500; //插入元素高度/单位px
					var num = 1;
					var totalheight = 0;
					$(window).scroll(function() {
						var srollPos = $(window).scrollTop(); //滚动条距顶部距离(页面超出窗口的高度)
						//console.log("滚动条到顶部的垂直高度: "+$(document).scrollTop());
						//console.log("页面的文档高度 ："+$(document).height());
						//console.log('浏览器的高度：'+$(window).height());
	
						totalheight = parseFloat($(window).height()) + parseFloat(srollPos);
						if(($(document).height() - range) <= totalheight && resetdata) {
							AddShopList();
						}
					});
				},150);
			}
			function BindImg() {
				isshop=false;
					if(uil!=null){
						$('#BoxImg').html(uil);
					
					TouchSlide({
						slideCell: "#slideBox",
						titCell: ".hd ul",
						mainCell: ".bd ul",
						effect: "leftLoop",
						delayTime: "1100",
						interTime: "3000",
						autoPage: true,
						autoPlay: true
					});
        			plus.nativeUI.closeWaiting();
					AddShopList();
				}
				else{
				setTimeout(function (){
						var ph = {
							Collection: [
								{ F: "ImgGS", O: "=", P: "@@ImgGS", V: 1 },
								{ F: "ImgType", O: "=", P: "@@ImgType", V: "首页轮播图" }
								
							]
						};
						var ar = new Array();
						ar.Condition = ph;
						ar.InterfaceAddress = "api/ShopInfo";
						ar.Name = "YL_Imgs";
						ar.OrderBy = "CreationDate desc";
						ar.Index = 0;
						ar.Size = 3;
						ar.Handshake_Time = CurentTime('-', true);
	
						aes(ar, "endk");
					},50);
				}
				
				
				$('.TypeMain').click(function(){
					if(plus.webview.getWebviewById("ProList")==""||plus.webview.getWebviewById("ProList")==undefined||plus.webview.getWebviewById("ProList")==null){}
					{plus.webview.getWebviewById("ProList").close();}
				 var nwaiting = plus.nativeUI.showWaiting();//显示原生等待框
								    webviewContent= plus.webview.create('ProList.html?type='+this.id,"ProList",{render:'always',});//后台创建webview并打开show.html
								       
								        webviewContent.show("slide-in-right",200); //把新webview窗体显示出来，显示动画效果为速度200毫秒的右侧移入动画
					
				});
			}
			BindImg();

			///minajax mui ajax 请求
			///h 请求的页面
			///id 传参的id
			function minajax(h, id) {
				mui.ajax(
					h, {
						data: {
							id: id,
						},

						dataType: "html",
						type: "get",
						success: function(data) {
							$('#bodyIDALL').html(data);
						},
						error: function(xhr) {
							console.log(xhr)
						}
					})
			}

			function endk(rd) {
				uil = "";
				var TData = eval("(" + rd + ")");
				for(var i = 0; i < TData.length; i++) {
					uil += '<li>';
					uil += '<a href="' + TData[i].Href + ';"><img src="' + imgsrc + TData[i].Id + '__750x360.jpg" width="100%" alt=""></a>';
					uil += '</li>';
				}
				$('#BoxImg').html(uil);
				
				TouchSlide({
					slideCell: "#slideBox",
					titCell: ".hd ul",
					mainCell: ".bd ul",
					effect: "leftLoop",
					delayTime: "1100",
					interTime: "3000",
					autoPage: true,
					autoPlay: true
				});
				

				$('#activityHd ul').attr("style", "display: none;")
				
        			plus.nativeUI.closeWaiting();
				AddShopList();
			}
			
			mui.init({

				swipeBack: true, //启用右滑关闭功能
				
			});
		</script>

	</body>

</html>